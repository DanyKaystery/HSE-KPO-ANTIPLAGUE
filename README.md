# Antiplague System 

–°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç—É–¥–µ–Ω—á–µ—Å–∫–∏—Ö —Ä–∞–±–æ—Ç –Ω–∞ –ø–ª–∞–≥–∏–∞—Ç —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —à–∏–Ω–≥–ª–æ–≤ –∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã.

---

##  –û–ø–∏—Å–∞–Ω–∏–µ

**Antiplague** ‚Äî —ç—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å—Ç—É–¥–µ–Ω—Ç–∞–º –∑–∞–≥—Ä—É–∂–∞—Ç—å —Å–≤–æ–∏ —Ä–∞–±–æ—Ç—ã –∏ –ø–æ–ª—É—á–∞—Ç—å –æ—Ç—á–µ—Ç –æ –ø—Ä–æ—Ü–µ–Ω—Ç–µ –ø–ª–∞–≥–∏–∞—Ç–∞ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –¥—Ä—É–≥–∏–º–∏ —Ä–∞–±–æ—Ç–∞–º–∏ —Ç–æ–≥–æ –∂–µ –∑–∞–¥–∞–Ω–∏—è. –°–∏—Å—Ç–µ–º–∞ —Ç–∞–∫–∂–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—â–∏—Ö—Å—è —Å–ª–æ–≤ –≤ —Ç–µ–∫—Å—Ç–∞—Ö (–æ–±–ª–∞–∫–∞ —Å–ª–æ–≤).

**–û—Å–Ω–æ–≤–Ω–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π:**
1. –°—Ç—É–¥–µ–Ω—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Ä–∞–±–æ—Ç—É (`.txt` –∏–ª–∏ `.md` —Ñ–∞–π–ª).
2. Gateway —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ñ–∞–π–ª –≤ Storage Service.
3. Analysis Service —Å–∫–∞—á–∏–≤–∞–µ—Ç —Ñ–∞–π–ª –∏ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç —Å –¥—Ä—É–≥–∏–º–∏ —Ä–∞–±–æ—Ç–∞–º–∏ —Ç–æ–≥–æ –∂–µ –∑–∞–¥–∞–Ω–∏—è.
4. –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –º–æ–∂–µ—Ç –∑–∞–ø—Ä–æ—Å–∏—Ç—å –æ–±–ª–∞–∫–æ —Å–ª–æ–≤.

---

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–°–∏—Å—Ç–µ–º–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 4 –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

API Gateway (port 9090) ‚Äî –µ–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤. –û—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é –∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º —Å–µ—Ä–≤–∏—Å–∞–º –∏ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏.

Storage Service (port 9091) ‚Äî –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞–º–∏. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É –∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, —Ö—Ä–∞–Ω–∏—Ç —Ñ–∞–π–ª—ã –ª–æ–∫–∞–ª—å–Ω–æ –∏–ª–∏ –≤ –æ–±–ª–∞–∫–µ.

Analysis Service (port 9092) ‚Äî –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø–ª–∞–≥–∏–∞—Ç–∞. –í—ã–ø–æ–ª–Ω—è–µ—Ç —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –Ω–æ–≤–æ–π —Ä–∞–±–æ—Ç—ã —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏, –≤—ã—á–∏—Å–ª—è–µ—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É—è –∞–ª–≥–æ—Ä–∏—Ç–º —Å—Ä–∞–≤–Ω–µ–Ω–∏—è (shingle).

PostgreSQL (port 5433) ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ä–∞–±–æ—Ç–∞—Ö, —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∞–Ω–∞–ª–∏–∑–∞ –ø–ª–∞–≥–∏–∞—Ç–∞ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.

–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö: –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –≤ Gateway (9090) -> Gateway –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É–µ—Ç –≤ Storage (9091) –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞ –∏ Analysis (9092) –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–ª–∞–≥–∏–∞—Ç–∞ -> –æ–±–∞ —Å–µ—Ä–≤–∏—Å–∞ —Ä–∞–±–æ—Ç–∞—é—Ç —Å PostgreSQL (5433) -> —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—É —á–µ—Ä–µ–∑ Gateway.

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### 1. **API Gateway** (cmd/gateway/main.go)
- **–ü–æ—Ä—Ç:** 9090
- **–†–æ–ª—å:** –ü—É–±–ª–∏—á–Ω–æ–µ REST API, –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏
- **–§—É–Ω–∫—Ü–∏–∏:**
    - –ü—Ä–∏–µ–º –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–æ–∫ —Ñ–∞–π–ª–æ–≤
    - –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è: –≤—ã–∑–æ–≤ Storage Service -> Analysis Service (–ø—Ä–æ–≤–µ—Ä–∫–∞)
    - Swagger UI –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ /swagger/index.html

#### 2. **Storage Service** (cmd/storage/main.go)
- **–ü–æ—Ä—Ç:** 9091
- **–†–æ–ª—å:** –ù–∞–¥–µ–∂–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –≤—ã–¥–∞—á–∞ —Ñ–∞–π–ª–æ–≤
- **–§—É–Ω–∫—Ü–∏–∏:**
    - POST /internal/upload ‚Äî —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –Ω–∞ –¥–∏—Å–∫ 
    - GET /internal/files/{id}/content ‚Äî —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –ø–æ ID
    - –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ PostgreSQL

#### 3. **Analysis Service** (cmd/analysis/main.go)
- **–ü–æ—Ä—Ç:** 9092
- **–†–æ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–ª–∞–≥–∏–∞—Ç –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–±–ª–∞–∫–∞ —Å–ª–æ–≤
- **–§—É–Ω–∫—Ü–∏–∏:**
    - POST /internal/analyze ‚Äî —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã —Å –¥—Ä—É–≥–∏–º–∏ (—à–∏–Ω–≥–ª–∏–Ω–≥)
    - GET /internal/analyze/{work_id}/wordcloud ‚Äî –æ–±–ª–∞–∫–æ —Å–ª–æ–≤ (–ë–æ–Ω—É—Å)
    - –°–∫–∞—á–∏–≤–∞–µ—Ç —Ñ–∞–π–ª—ã –∏–∑ Storage Service
    - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –æ—Ç—á–µ—Ç—ã –≤ PostgreSQL

#### 4. **PostgreSQL** 
- **–ü–æ—Ä—Ç:** 5433 (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è), –≤–Ω—É—Ç—Ä–∏ Docker: 5432
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** antiplague_db
- **–¢–∞–±–ª–∏—Ü—ã:**
    - works ‚Äî –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç (ID, student, assignment, file_id)
    - files ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∞–π–ª–∞—Ö (—Ö—Ä–∞–Ω–∏–ª–∏—â–µ, –ø—É—Ç—å, —Ä–∞–∑–º–µ—Ä)
    - plagiarism_reports ‚Äî –æ—Ç—á–µ—Ç—ã (score, matched_work_id, —Å—Ç–∞—Ç—É—Å)

---

## –ê–ª–≥–æ—Ä–∏—Ç–º –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –ø–ª–∞–≥–∏–∞—Ç–∞

**W-Shingling (–û–∫–æ–Ω–Ω–∞—è —à–∏–Ω–≥–ª—è):**

1. **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è:** –¢–µ–∫—Å—Ç –ø—Ä–∏–≤–æ–¥–∏—Ç—Å—è –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É, —É–¥–∞–ª—è—é—Ç—Å—è –∑–Ω–∞–∫–∏ –ø—Ä–µ–ø–∏–Ω–∞–Ω–∏—è.
2. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ:** –¢–µ–∫—Å—Ç —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏–∑ 3 —Å–ª–æ–≤.
3. **–•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ö–∞–∂–¥–æ–π —à–∏–Ω–≥–ª–µ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Ö–µ—à.
4. **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ:** –î–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã —Ä–∞–±–æ—Ç –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ñ–∞–∫–∫–∞—Ä–∞:


   Score = (–ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤ —Ö–µ—à–µ–π) / (–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤ —Ö–µ—à–µ–π)


5. **–ü–æ—Ä–æ–≥–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:** –ï—Å–ª–∏ Score > 0.85 -> is_plagiarized = true.

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** O(n), –≥–¥–µ n ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–≤ –≤ —Ç–µ–∫—Å—Ç–µ.

---

## –ë–æ–Ω—É—Å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å: –û–±–ª–∞–∫–æ —Å–ª–æ–≤

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—â–∏—Ö—Å—è —Å–ª–æ–≤:

- **Endpoint:** GET /api/v1/works/{work_id}/wordcloud
- **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è QuickChart.io API
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** PNG-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ —Å–ª–æ–≤–∞–º–∏ —Ä–∞–∑–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ (—á–∞—Å—Ç–æ—Ç–∞ a —Ä–∞–∑–º–µ—Ä)
- **–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
  ```json
  {
    "word_cloud_url": "https://quickchart.io/wordcloud?text=...",
    "work_id": "a1b2c3d4-..."
  }
  ```

---

## –ó–∞–ø—É—Å–∫

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Docker Desktop (–∏–ª–∏ Docker + Docker Compose)
- –ü–æ—Ä—Ç—ã 9090, 9091, 9092, 5433 —Å–≤–æ–±–æ–¥–Ω—ã

### –ö–æ–º–∞–Ω–¥–∞

```bash

~/go/bin/swag init -g main.go \
  --dir ./cmd/gateway,./internal/dto \
  --output ./docs

docker compose up -d --build

docker compose ps

curl http://localhost:9090/swagger/index.html
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞
```bash
docker compose down -v 
```

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API

### Swagger UI
–ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞: 
**[http://localhost:9090/swagger/index.html](http://localhost:9090/swagger/index.html)**

### –û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

#### 1. –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–∞–±–æ—Ç—ã (–û—Å–Ω–æ–≤–Ω–æ–µ)
```bash
curl -X POST http://localhost:9090/api/v1/works \
  -F "assignment_id=550e8400-e29b-41d4-a716-446655440000" \
  -F "student_id=123e4567-e89b-12d3-a456-426614174000" \
  -F "file=@work.txt"
```

**–û—Ç–≤–µ—Ç (202 Accepted):**
```json
{
  "success": true,
  "data": {
    "work_id": "7d6d1bbf-1a4d-46d7-b184-9b4bc37b9250",
    "submitted_at": "2025-12-10T21:58:55Z",
    "plagiarism_check": {
      "is_plagiarized": false,
      "score": 0.0,
      "status": "checked"
    }
  }
}
```

#### 2. –û–±–ª–∞–∫–æ —Å–ª–æ–≤ (–ë–æ–Ω—É—Å)
```bash
curl http://localhost:9090/api/v1/works/7d6d1bbf-1a4d-46d7-b184-9b4bc37b9250/wordcloud
```

**–û—Ç–≤–µ—Ç (200 OK):**
```json
{
  "word_cloud_url": "https://quickchart.io/wordcloud?text=golang+docker+microservices...",
  "work_id": "7d6d1bbf-1a4d-46d7-b184-9b4bc37b9250"
}
```

#### 3. Health Check
```bash
curl http://localhost:9090/health
```

---




##  –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Unit —Ç–µ—Å—Ç—ã
```bash
go test ./internal/domain/plagiarism/... -v
```

### Integration —Ç–µ—Å—Ç—ã (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–ø—É—â–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä)
```bash
go test ./tests/integration/... -v
```

---
